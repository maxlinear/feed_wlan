From dc2cab8902c01be42d6ca0239d286187c2802d21 Mon Sep 17 00:00:00 2001
From: mj <mj@maxlinear.com>
Date: Mon, 25 Nov 2024 12:46:11 +0530
Subject: [PATCH] WLANRTSYS-86324 Added NULL check for hapd priv before doing
 set key

---
 src/ap/ap_drv_ops.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/ap/ap_drv_ops.c b/src/ap/ap_drv_ops.c
index 559d6a0f8..87c2e30f4 100644
--- a/src/ap/ap_drv_ops.c
+++ b/src/ap/ap_drv_ops.c
@@ -767,7 +767,11 @@ int hostapd_drv_set_key(const char *ifname, struct hostapd_data *hapd,
 {
 	struct wpa_driver_set_key_params params;
 
+#ifdef CONFIG_IEEE80211BE_MXL_MLO
+	if (hapd->driver == NULL || hapd->driver->set_key == NULL || hapd->drv_priv == NULL)
+#else
 	if (hapd->driver == NULL || hapd->driver->set_key == NULL)
+#endif /* CONFIG_IEEE80211BE_MXL_MLO */
 		return 0;
 
 	os_memset(&params, 0, sizeof(params));
-- 
2.43.0

